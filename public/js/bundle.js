!function(e){var o={};function n(t){if(o[t])return o[t].exports;var i=o[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=o,n.d=function(e,o,t){n.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:t})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,o){if(1&o&&(e=n(e)),8&o)return e;if(4&o&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&o&&"string"!=typeof e)for(var i in e)n.d(t,i,function(o){return e[o]}.bind(null,i));return t},n.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(o,"a",o),o},n.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},n.p="",n(n.s=0)}([function(e,o,n){e.exports=n(2)},function(e,o){window.socket=io()},function(o,n,t){"use strict";t.r(n);t(1);function i(e,o){for(var n=0;n<o.length;n++){var t=o[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}var r=function(){function o(e){!function(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}(this,o),this.id=e,this.videos=[],this.peers=[]}var n,t,r;return n=o,(t=[{key:"getVideo",value:function(e){return this.videos[e]}},{key:"getVideoSrc",value:function(e){return this.videos[e].srcObject}},{key:"addVideo",value:function(e,o){this.videos[e]=o}},{key:"addVideoSrc",value:function(e,o){this.videos[e].srcObject=o}},{key:"deleteVideo",value:function(e){$("#".concat(e)).remove(),delete this.videos[e]}},{key:"deletePeer",value:function(e){this.peers[e].destroy(),delete this.peers[e]}},{key:"addPeer",value:function(o,n){var t=this,i={initiator:n,stream:this.getVideoSrc(this.id)},r=new SimplePeer(i);$("#video-container").append('<video class="video" id="'.concat(o,'" autoplay></video>')),console.log("Peer available for connection discovered from signalling server, Peer ID: %s",o),socket.on("signal",function(e){e.peerId==o&&(console.log("Received signalling data",e,"from Peer ID:",o),r.signal(e.signal))}),r.on("signal",function(e){console.log("Advertising signalling data",e,"to Peer ID:",o),socket.emit("signal",{signal:e,peerId:o})}),r.on("error",function(){console.log("Error sending connection to peer %s:",o,e)}),r.on("connect",function(){console.log("Peer connection established")}),r.on("data",function(e){console.log("Recieved data from peer:",e)}),r.on("stream",function(e){t.addVideo(o,$("#".concat(o))[0]),t.addVideoSrc(o,e)}),this.peers[o]=r}},{key:"start",value:function(){var e=this;navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then(function(o){e.addVideoSrc(e.id,o),socket.emit("ready"),e.ready()}).catch(function(e){console.log(e)})}},{key:"ready",value:function(){}}])&&i(n.prototype,t),r&&i(n,r),o}();socket.on("connect",function(){window.controller=new r(socket.id),controller.addVideo(socket.id,$("#localVideo")[0]),controller.start()}),socket.on("peer",function(e){controller.addPeer(e.peerId,e.initiator)}),socket.on("disconnect",function(e){controller.deletePeer(e),controller.deleteVideo(e)}),""==windowlocation.hash&&(window.location.href=location.href.replace(location.hash,""))}]);